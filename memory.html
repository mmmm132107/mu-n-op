<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Memory</title>

<link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  min-height:220vh;
  font-family:"Be Vietnam Pro",system-ui,sans-serif;
  color:#f2e8dc;
  overflow-x:hidden;
  scroll-behavior:smooth;

  background:
    radial-gradient(1200px 600px at 20% -10%, rgba(150,180,255,.15), transparent),
    radial-gradient(900px 700px at 90% 20%, rgba(255,160,200,.12), transparent),
    radial-gradient(800px 900px at 40% 120%, rgba(180,220,255,.12), transparent),
    linear-gradient(#06080c,#05060a,#090911);
}

/* title */
.center{
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}
.title{
  font-size:42px;
  letter-spacing:1.4px;
  cursor:pointer;
  transition:.35s;
  text-shadow:0 0 30px rgba(220,230,255,.25);
}
.title:hover{
  transform:scale(1.06);
  text-shadow:0 0 36px rgba(230,240,255,.6);
}

/* frame */
.square{
  width:16px;height:16px;
  border:1px solid rgba(230,215,200,.55);
  position:absolute;
}

/* fade */
.fade{
  position:fixed;
  inset:0;
  background:#000;
  opacity:0;
  pointer-events:none;
  transition:1s ease;
}
.fade.show{opacity:1}

/* story */
.story{
  max-width:880px;
  margin:120px auto 300px;
  padding:0 28px;
  font-size:17px;
  line-height:1.8;
  opacity:0;
  transform:translateY(20px);
  transition:.7s;
}
.story.show{
  opacity:1;
  transform:translateY(0);
}

/* ➜ stay button — góc phải nhưng KHÔNG cố định */
.choice-wrapper{
  max-width:980px;
  margin:160px auto 250px;
  padding:0 28px;
}

.choice-arrow{
  margin-left:auto;
  width:max-content;
  padding:10px 18px 10px 14px;
  border:1px solid rgba(230,215,200,.6);
  border-radius:14px;
  font-size:16px;
  display:flex;
  align-items:center;
  gap:6px;
  opacity:0;
  cursor:pointer;
  transition:.35s;
  background:rgba(22,22,24,.35);
  backdrop-filter:blur(6px);
}

.choice-arrow::after{
  content:"➜";
  font-size:18px;
}

.choice-arrow.show{opacity:1;}
.choice-arrow:hover{transform:translateX(3px);}
</style>
</head>

<body>

<div class="fade" id="fade"></div>

<section class="center">
  <div class="title" id="goCall">rendezvous</div>
</section>

<section id="story" class="story"></section>

<div class="choice-wrapper">
  <div id="arrow" class="choice-arrow">stay</div>
</div>

<script>
const fade  = document.getElementById("fade");
const story = document.getElementById("story");
const arrow = document.getElementById("arrow");
const goCall = document.getElementById("goCall");

/* click title → rendezvous */
goCall.onclick = () => window.location.href = "rendezvous.html";

/* text */
const text =
"Con ngựa ấy ở lại bãi cỏ vì ngũ cốc và mái chuồng quen thuộc. "+
"Nó nhiều lần tự nhủ rằng rồi sẽ rời đi và chạy đến một dải thảo nguyên xanh ngắt. "+
"Nhưng mỗi lần đến sát ranh giới của sự dứt bỏ, tim nó lại mềm ra trước những điều đã làm nó hạnh phúc. "+
"Phía trước là tự do, còn phía sau là người đã buộc sợi dây bằng cả quan tâm lẫn sự tiện lợi. "+
"Và thế là nó quay đầu. Nó đã lỡ yêu nơi ấy quá nhiều để rời đi.";

/* typewriter — có callback */
function typewriter(el, str, speed=24, done){
  el.innerHTML="";
  let i=0;
  (function step(){
    if(i < str.length){
      el.innerHTML += str[i++];
      setTimeout(step, speed);
    } else {
      done && done();
    }
  })();
}

let autoRedirect;

/* frame + secret bottom-left */
function createFrame(){
  const gap=32;
  const rows=Math.floor(window.innerHeight/gap);
  const cols=Math.floor(window.innerWidth/gap);

  const secretR=rows;
  const secretC=0;

  for(let r=0;r<=rows;r++){
    for(let c=0;c<=cols;c++){

      const edge=r===0||r===rows||c===0||c===cols;
      if(!edge) continue;

      const s=document.createElement("div");
      s.className="square";
      s.style.top=r*gap+"px";
      s.style.left=c*gap+"px";

      if(r===secretR && c===secretC)
        s.addEventListener("click", triggerSecret);

      document.body.appendChild(s);
    }
  }
}
createFrame();

/* click secret square */
function triggerSecret(){

  fade.classList.add("show");

  setTimeout(()=>{

    fade.classList.remove("show");
    story.scrollIntoView({behavior:"smooth"});

    setTimeout(()=>{

      story.classList.add("show");

      /* chạy text */
      typewriter(story, text, 20, () => {

        /* ✓ chỉ khi text gõ XONG → mới xuất hiện stay */
        arrow.classList.add("show");
        /* mũi tên ở KHỐI BÊN DƯỚI → phải scroll mới thấy */

      });

      /* ⚠ auto chuyển khi text CHƯA gõ xong */
      autoRedirect = setTimeout(()=>{
        window.location.href = "Thecall.html";
      }, 3500);   // chỉnh thời gian tùy cảm giác

    }, 400);

  }, 900);
}

/* nếu người dùng kịp kéo xuống & chọn stay */
arrow.onclick = ()=>{
  clearTimeout(autoRedirect);
  window.location.href = "stay.html";
};
</script>

</body>
</html>

