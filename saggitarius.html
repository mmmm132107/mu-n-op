<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>sagittarius</title>

<style>

body{
  margin:0;
  height:100vh;
  background:#06070b;
  color:#e6e6e6;
  font-family:serif;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
}

/* tiêu đề */
h3{
  margin-bottom:6px;
  font-weight:300;
}
.sub{ opacity:.7; font-style:italic; margin-bottom:14px; }

/* khung tổng */
.board-wrap{
  display:grid;
  grid-template-columns:30px auto;
  grid-template-rows:auto 30px;
  gap:4px;
}

/* nhãn trục */
.axis{
  display:grid;
  place-items:center;
  color:#aeb7d2;
  font-size:14px;
}

/* bảng 8×8 */
.board{
  display:grid;
  grid-template-columns:repeat(8,72px);
  grid-template-rows:repeat(8,72px);
  border-radius:12px;
  overflow:hidden;
  border:2px solid #2b3558;
  box-shadow:0 0 36px rgba(120,150,220,.25);
}

.cell{
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:36px;
  user-select:none;
  cursor:pointer;
}

.light{ background:#f4f6fc; }
.dark { background:#8fa0c8; }

.cell:hover{
  outline:2px solid rgba(220,240,255,.7);
}

.goal{
  box-shadow: inset 0 0 14px rgba(180,220,255,.9);
}

/* thông báo */
#msg{
  margin-top:16px;
  opacity:0;
  transition:.8s;
}
#msg.reveal{ opacity:1; }

button{
  margin-top:8px;
  padding:8px 14px;
  border-radius:8px;
  border:1px solid #2f3958;
  background:#1a233c;
  color:#e6e6e6;
  cursor:pointer;
}
button:hover{ background:#223054; }

</style>
</head>

<body>

<h3>play the plot.</h3>
<div class="sub">play the horse.</div>

<div class="board-wrap">

  <!-- trục dọc (8→1) -->
  <div id="yAxis" class="axis"></div>

  <!-- bàn cờ -->
  <div class="board" id="board"></div>

  <!-- trục ngang (a→h) -->
  <div></div>
  <div id="xAxis" class="axis"></div>
</div>

<div id="msg">
  <p>the pieces moved as written.</p>
  <button onclick="next()">continue</button>
</div>

<script>

/*
  TOẠ ĐỘ

  row 0 → rank 8
  row 7 → rank 1
  col 0 → a
  col 7 → h

  TRẠNG THÁI BAN ĐẦU (theo hình)

  ♚ vua đen  = b8 → (0,1)
  ♔ vua trắng = b6 → (2,1)
  ♗ tượng     = e6 → (2,4)
  ♞ mã        = c5 → (3,2)

  YÊU CẦU DIỄN BIẾN

  1️⃣ người chơi đi ♞ c5 → a6 (3,2 → 2,0)
  2️⃣ máy đi ♚ b8 → a8 (0,1 → 0,0)
  3️⃣ máy đi ♗ e6 → d5 (2,4 → 3,3)
*/

const board = document.getElementById("board");

/* toạ độ quân */
let knight = { r:3, c:2 }; // c5
let kingBlack = { r:0, c:1 }; // b8
let kingWhite = { r:2, c:1 }; // b6
let bishop    = { r:2, c:4 }; // e6

/* checkpoint */
const STEP1_TARGET = { r:2, c:0 }; // a6

let progressed = false;

/* trục toạ độ */
(function drawAxes(){
  const y = document.getElementById("yAxis");
  const x = document.getElementById("xAxis");

  for(let i=8;i>=1;i--){
    const d=document.createElement("div");
    d.textContent=i;
    y.appendChild(d);
  }

  for(let c of "abcdefgh"){
    const d=document.createElement("div");
    d.textContent=c;
    x.appendChild(d);
  }
})();

/* vẽ bàn */
function draw(){
  board.innerHTML = "";

  for(let r=0;r<8;r++){
    for(let c=0;c<8;c++){

      const cell = document.createElement("div");
      cell.className = "cell " + ((r+c)%2===0 ? "light" : "dark");

      if(r===knight.r && c===knight.c) cell.textContent="♞";
      if(r===bishop.r && c===bishop.c) cell.textContent="♗";
      if(r===kingWhite.r && c===kingWhite.c) cell.textContent="♔";
      if(r===kingBlack.r && c===kingBlack.c) cell.textContent="♚";

      cell.onclick = ()=>tryMove(r,c);

      board.appendChild(cell);
    }
  }
}

draw();

/* luật đi quân mã */
function isKnightMove(r,c){
  const dr = Math.abs(r-knight.r);
  const dc = Math.abs(c-knight.c);
  return (dr===2 && dc===1) || (dr===1 && dc===2);
}

/* reset */
function reset(){
  knight = { r:3, c:2 };
  kingBlack = { r:0, c:1 };
  bishop    = { r:2, c:4 };
  progressed = false;
  draw();
}

/* xử lý nước đi */
function tryMove(r,c){

  if(!isKnightMove(r,c)) return reset();

  // bước yêu cầu duy nhất: c5 → a6
  if(!progressed){

    // phải đúng ô a6
    if(r===STEP1_TARGET.r && c===STEP1_TARGET.c){

      knight = {r,c};
      progressed = true;
      draw();

      // máy tự đi 2 nước kế
      setTimeout(()=>{
        kingBlack = { r:0, c:0 }; // b8→a8
        draw();

        setTimeout(()=>{
          bishop = { r:3, c:3 }; // e6→d5
          draw();
          finish();
        }, 600);

      }, 600);

    } else return reset();
  }
}

/* hoàn tất cảnh */
function finish(){
  document.getElementById("msg").classList.add("reveal");
}

function next(){
  window.location.href = "memory.html";
}

</script>

</body>
</html>

</body>
</html>


