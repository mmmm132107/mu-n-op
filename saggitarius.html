<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>sagittarius</title>

<style>

body{
  margin:0;
  height:100vh;
  background:#05060a;
  color:#e6e6e6;
  font-family:serif;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
}

h3{
  margin-bottom:10px;
  font-weight:300;
  opacity:.9;
}

.sub{
  opacity:.7;
  margin-bottom:14px;
  font-style:italic;
}

.board{
  display:grid;
  grid-template-columns:repeat(8,70px);
  grid-template-rows:repeat(8,70px);
  border:1px solid #2b3248;
  border-radius:12px;
  overflow:hidden;
  box-shadow:0 0 40px rgba(90,120,190,.25);
}

.cell{
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:34px;
  cursor:pointer;
}

.light{ background:#f5f6fb; }
.dark{ background:#7d8ab4; }

.cell:hover{
  outline:2px solid rgba(200,230,255,.6);
}

.goal{
  box-shadow: inset 0 0 14px rgba(180,220,255,.9);
}

#msg{
  margin-top:18px;
  text-align:center;
  opacity:0;
  transition:.9s;
}

#msg.reveal{
  opacity:1;
}

button{
  margin-top:8px;
  padding:8px 14px;
  border-radius:8px;
  border:1px solid #2f3958;
  background:#18223a;
  color:#e6e6e6;
  cursor:pointer;
}

button:hover{ background:#223054; }

</style>
</head>

<body>

<h3>play the plot.</h3>
<div class="sub">play the horse.</div>

<div class="board" id="board"></div>

<div id="msg">
  <p>the arrow reached its final square.</p>
  <button onclick="next()">continue</button>
</div>

<script>

/*
  ===== COORDINATES =====

  row 0 = rank 8
  row 7 = rank 1
  col 0 = a
  col 7 = h

  DIỄN BIẾN YÊU CẦU:

  start  = c5 → (r3,c2)
  step1  = a6 → (r2,c0)
  step2  = d7 → (r1,c3)  ✓ thắng
*/

/* ===== PIECE POSITIONS ===== */

const START = { r:3, c:2 };  // c5
const STEP1 = { r:2, c:0 };  // a6
const GOAL  = { r:1, c:3 };  // d7 ✔

let knight = {...START};
let progress = 0; // 0 = chưa bước, 1 = đã tới a6

const KING_WHITE = { r:2, c:1 }; // b6
const BISHOP     = { r:2, c:0 }; // (cùng ô a6 thời điểm kết thúc)
const KING_BLACK = { r:0, c:1 }; // b8

const board = document.getElementById("board");


/* ===== RENDER ===== */

function draw(){
  board.innerHTML = "";

  for(let r=0;r<8;r++){
    for(let c=0;c<8;c++){

      const cell = document.createElement("div");
      cell.className = "cell " + ((r+c)%2===0 ? "light" : "dark");

      if(r===GOAL.r && c===GOAL.c){
        cell.classList.add("goal");
      }

      if(r===KING_BLACK.r && c===KING_BLACK.c) cell.textContent="♚";
      if(r===KING_WHITE.r && c===KING_WHITE.c) cell.textContent="♔";
      if(r===BISHOP.r     && c===BISHOP.c)     cell.textContent="♗";
      if(r===knight.r     && c===knight.c)     cell.textContent="♞";

      cell.onclick = ()=>move(r,c);

      board.appendChild(cell);
    }
  }
}

draw();


/* ===== RULE: only knight moves ===== */

function isKnightMove(r,c){
  const dr = Math.abs(r-knight.r);
  const dc = Math.abs(c-knight.c);
  return (dr===2 && dc===1) || (dr===1 && dc===2);
}


/* ===== GAME LOGIC ===== */

function move(r,c){

  // phải đi đúng kiểu quân mã
  if(!isKnightMove(r,c)) return reset();

  // BƯỚC 1 — bắt buộc c5 → a6
  if(progress === 0){
    if(r===STEP1.r && c===STEP1.c){
      knight = {r,c};
      progress = 1;
      return draw();
    }
    else return reset();
  }

  // BƯỚC 2 — bắt buộc a6 → d7
  if(progress === 1){
    if(r===GOAL.r && c===GOAL.c){
      knight = {r,c};
      draw();
      return win();
    }
    else return reset();
  }
}

function reset(){
  knight = {...START};
  progress = 0;
  draw();
}

function win(){
  document.getElementById("msg").classList.add("reveal");
}

function next(){
  window.location.href = "memory.html";
}

</script>

</body>
</html>


